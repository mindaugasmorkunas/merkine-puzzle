const answers={1:"dzukija",2:"nemunas",3:["7","8","9","10","11"],4:"north",5:"4",6:"wladyslaw"};let solvedQuestions=new Set,totalQuestions=6;const STORAGE_KEY="merkine-puzzle-progress";function saveProgress(){const e={solvedQuestions:Array.from(solvedQuestions),answers:{},timestamp:Date.now()};solvedQuestions.forEach(t=>{const s=document.getElementById(`answer${t}`);s&&(e.answers[t]=s.value)}),sessionStorage.setItem(STORAGE_KEY,JSON.stringify(e))}function loadProgress(){try{const e=sessionStorage.getItem(STORAGE_KEY);if(e){const t=JSON.parse(e);if(t.solvedQuestions&&Array.isArray(t.solvedQuestions))return solvedQuestions=new Set(t.solvedQuestions),t}}catch(e){console.log("Error loading progress:",e)}return null}function restorePuzzleState(e){0!==solvedQuestions.size&&(solvedQuestions.forEach(t=>{const s=document.querySelector(`[data-question="${t}"]`),o=document.getElementById(`answer${t}`),n=document.getElementById(`feedback${t}`);s&&o&&n&&(e.answers&&void 0!==e.answers[t]&&(o.value=e.answers[t]),s.classList.add("solved"),o.disabled=!0,o.nextElementSibling.disabled=!0,n.textContent="✅ Correct! Puzzle piece revealed!",n.className="feedback correct show",revealPuzzlePiece(t))}),updateProgress(),solvedQuestions.size===totalQuestions&&setTimeout(()=>{revealCenterPiece(),showTrailReveal()},500))}function checkAnswer(e){const t=document.getElementById(`answer${e}`),s=document.getElementById(`feedback${e}`),o=document.querySelector(`[data-question="${e}"]`);let n;if("number"===t.type){if(n=parseInt(t.value),isNaN(n))return s.classList.add("show"),s.textContent="⚠️ Please enter a valid number.",void(s.className="feedback incorrect show")}else if("SELECT"===t.tagName){if(n=t.value.toLowerCase().trim(),""===n)return s.classList.add("show"),s.textContent="⚠️ Please select an option.",void(s.className="feedback incorrect show")}else if(n=t.value.toLowerCase().trim(),""===n)return s.classList.add("show"),s.textContent="⚠️ Please enter an answer before submitting.",void(s.className="feedback incorrect show");let r=!1;r=Array.isArray(answers[e])?answers[e].includes(n):n===answers[e],s.classList.add("show"),r?(s.textContent="✅ Correct! Puzzle piece revealed!",s.className="feedback correct show",o.classList.add("solved"),t.disabled=!0,t.nextElementSibling.disabled=!0,solvedQuestions.add(e),saveProgress(),revealPuzzlePiece(e),updateProgress(),solvedQuestions.size===totalQuestions&&setTimeout(()=>{revealCenterPiece(),showTrailReveal()},1e3)):(s.textContent="❌ Not quite right. Try again!",s.className="feedback incorrect show",1===e?s.textContent+=" Hint: This park is famous for its pine forests and is located in southern Lithuania.":2===e?s.textContent+=" Hint: It's Lithuania's longest river.":3===e?s.textContent+=" Hint: A typical forest loop trail is around 8-10 km.":4===e?s.textContent+=" Hint: Think about following the river meanders from town.":5===e?s.textContent+=" Hint: Think about a comfortable pace for 9km with photo stops and rest breaks.":6===e&&(s.textContent+=" Hint: This king was from the Vasa dynasty and ruled in the 17th century."))}function updateProgress(){const e=document.getElementById("progressFill"),t=document.getElementById("progressText"),s=solvedQuestions.size/totalQuestions*100;e.style.width=s+"%",t.textContent=`Progress: ${solvedQuestions.size}/${totalQuestions} clues solved`}function revealPuzzlePiece(e){const t=document.getElementById(`piece${e}`);if(t){t.classList.add("revealed"),t.style.transform="scale(1.1)",setTimeout(()=>{t.style.transform="scale(1)"},300);const e=t.querySelector(".piece-overlay").querySelector(".piece-status");e.textContent="✅ Unlocked!",e.style.color="#2ecc71",createSparkles(t)}}function revealCenterPiece(){const e=document.getElementById("pieceCenter");if(e){e.classList.add("revealed"),e.style.transform="scale(1.2)",setTimeout(()=>{e.style.transform="scale(1)"},500);const t=e.querySelector(".piece-overlay").querySelector(".piece-status");t.textContent="🎉 Trail Revealed!",t.style.color="#e74c3c"}}function createSparkles(e){const t=e.getBoundingClientRect(),s=["#2ecc71","#3498db","#e74c3c","#f39c12","#9b59b6"];for(let e=0;e<8;e++)setTimeout(()=>{const e=document.createElement("div");e.style.position="fixed",e.style.left=t.left+Math.random()*t.width+"px",e.style.top=t.top+Math.random()*t.height+"px",e.style.width="6px",e.style.height="6px",e.style.backgroundColor=s[Math.floor(Math.random()*s.length)],e.style.borderRadius="50%",e.style.pointerEvents="none",e.style.zIndex="9999",document.body.appendChild(e);e.animate([{transform:"translate(0, 0) scale(1)",opacity:1},{transform:`translate(${100*(Math.random()-.5)}px, ${100*(Math.random()-.5)}px) scale(0)`,opacity:0}],{duration:1e3,easing:"ease-out"}).onfinish=()=>e.remove()},100*e)}function showTrailReveal(){const e=document.getElementById("trailReveal");e.classList.add("show"),e.scrollIntoView({behavior:"smooth"}),createConfetti()}function resetPuzzle(){solvedQuestions.clear(),sessionStorage.removeItem(STORAGE_KEY);for(let e=1;e<=totalQuestions;e++){const t=document.getElementById(`answer${e}`),s=document.getElementById(`feedback${e}`),o=document.querySelector(`[data-question="${e}"]`),n=o.querySelector("button");t.value="",t.disabled=!1,n.disabled=!1,s.classList.remove("show"),o.classList.remove("solved");const r=document.getElementById(`piece${e}`);if(r){r.classList.remove("revealed"),r.style.transform="scale(1)";const t=r.querySelector(".piece-overlay").querySelector(".piece-status"),s=["Historic Clue","Nature Clue","Geography Clue","Navigation Clue","Trail Clue","Royal Clue"];t.textContent=`🔒 Solve ${s[e-1]}`,t.style.color="white"}}const e=document.getElementById("pieceCenter");if(e){e.classList.remove("revealed"),e.style.transform="scale(1)";const t=e.querySelector(".piece-overlay").querySelector(".piece-status");t.textContent="🏁 Complete All Clues",t.style.color="white"}updateProgress(),document.getElementById("trailReveal").classList.remove("show"),window.scrollTo({top:0,behavior:"smooth"})}function createConfetti(){const e=["#2ecc71","#3498db","#e74c3c","#f39c12","#9b59b6"];for(let t=0;t<50;t++)setTimeout(()=>{const t=document.createElement("div");t.style.position="fixed",t.style.top="-10px",t.style.left=100*Math.random()+"vw",t.style.width="10px",t.style.height="10px",t.style.backgroundColor=e[Math.floor(Math.random()*e.length)],t.style.pointerEvents="none",t.style.zIndex="9999",t.style.borderRadius="50%",document.body.appendChild(t);t.animate([{transform:"translateY(-10px) rotate(0deg)",opacity:1},{transform:"translateY(100vh) rotate(720deg)",opacity:0}],{duration:3e3,easing:"ease-out"}).onfinish=()=>t.remove()},100*t)}document.addEventListener("DOMContentLoaded",function(){const e=loadProgress();e&&(console.log("Restored puzzle progress from session"),restorePuzzleState(e));for(let e=1;e<=totalQuestions;e++){document.getElementById(`answer${e}`).addEventListener("keypress",function(t){"Enter"===t.key&&checkAnswer(e)})}}),updateProgress();